#!/bin/bash
# Task 3: Summarize PokÃ©mon Data

INPUT_DIR="pokemon_data"
OUTPUT_FILE="pokemon_report.csv"

if [[ ! -d "$INPUT_DIR" ]]; then
    echo "Error: $INPUT_DIR not found."
    exit 1
fi

echo "Name,Height (m),Weight (kg)" > "$OUTPUT_FILE"

# Extract data from each JSON
for file in "$INPUT_DIR"/*.json; do
    NAME=$(jq -r '.name' "$file" | sed 's/.*/\u&/')
    HEIGHT=$(jq -r '.height' "$file" | awk '{printf "%.1f", $1/10}')
    WEIGHT=$(jq -r '.weight' "$file" | awk '{printf "%.1f", $1/10}')
    echo "$NAME,$HEIGHT,$WEIGHT" >> "$OUTPUT_FILE"
done

# Calculate averages
AVG_HEIGHT=$(awk -F, 'NR>1 {sum+=$2; count++} END {if(count>0) printf "%.2f", sum/count}' "$OUTPUT_FILE")
AVG_WEIGHT=$(awk -F, 'NR>1 {sum+=$3; count++} END {if(count>0) printf "%.2f", sum/count}' "$OUTPUT_FILE")

echo -e "\nAverage Height: $AVG_HEIGHT m"
echo "Average Weight: $AVG_WEIGHT kg"
echo "CSV Report generated at: $OUTPUT_FILE"
